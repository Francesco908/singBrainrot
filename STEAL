-- Sing Hub Complete Auto Game Script
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local ProximityPromptService = game:GetService("ProximityPromptService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

-- Variables
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")
local camera = Workspace.CurrentCamera

-- Control variables
local autoFarmMoneyEnabled = false
local autoBuyEggsEnabled = false
local autoGameEnabled = false
local espEnabled = false
local fastOpenEnabled = false
local flyEnabled = false
local originalWalkSpeed = humanoid.WalkSpeed
local farmConnection
local buyConnection
local gameConnection
local flyConnection
local espBoxes = {}
local bodyVelocity = nil

-- Flying System
local function setupFly()
    if bodyVelocity then
        bodyVelocity:Destroy()
    end
    
    bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
    bodyVelocity.Velocity = Vector3.new(0, 0, 0)
    bodyVelocity.Parent = rootPart
    
    local bodyAngularVelocity = Instance.new("BodyAngularVelocity")
    bodyAngularVelocity.MaxTorque = Vector3.new(0, math.huge, 0)
    bodyAngularVelocity.AngularVelocity = Vector3.new(0, 0, 0)
    bodyAngularVelocity.Parent = rootPart
end

local function toggleFly()
    if flyEnabled then
        setupFly()
        flyConnection = RunService.Heartbeat:Connect(function()
            if bodyVelocity then
                bodyVelocity.Velocity = Vector3.new(0, 2, 0)
            end
        end)
    else
        if bodyVelocity then
            bodyVelocity:Destroy()
            bodyVelocity = nil
        end
        if flyConnection then
            flyConnection:Disconnect()
            flyConnection = nil
        end
    end
end

-- ESP Functions
local function createESPBox(obj, color, text)
    if not obj or not obj.Parent then return end
    
    local billboardGui = Instance.new("BillboardGui")
    billboardGui.Name = "ESPBox"
    billboardGui.Size = UDim2.new(0, 100, 0, 50)
    billboardGui.StudsOffset = Vector3.new(0, 2, 0)
    billboardGui.AlwaysOnTop = true
    billboardGui.Parent = obj
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, 0, 1, 0)
    frame.BackgroundColor3 = color
    frame.BackgroundTransparency = 0.7
    frame.BorderSizePixel = 2
    frame.BorderColor3 = color
    frame.Parent = billboardGui
    
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = text
    textLabel.TextColor3 = Color3.new(1, 1, 1)
    textLabel.TextScaled = true
    textLabel.Font = Enum.Font.SourceSansBold
    textLabel.Parent = frame
    
    table.insert(espBoxes, billboardGui)
    return billboardGui
end

local function clearESP()
    for _, box in pairs(espBoxes) do
        if box and box.Parent then
            box:Destroy()
        end
    end
    espBoxes = {}
end

local function updateESP()
    if not espEnabled then return end
    
    clearESP()
    
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj.Name:match("^Item%d*$") then
            createESPBox(obj, Color3.new(0, 1, 0), "ITEM")
        elseif obj.Name:match("^Egg%d*$") then
            createESPBox(obj, Color3.new(1, 1, 0), "EGG")
        elseif obj.Name:lower():find("money") or obj.Name:lower():find("cash") or obj.Name:lower():find("coin") then
            createESPBox(obj, Color3.new(0, 0, 1), "MONEY")
        elseif obj.Name:lower():find("sell") or obj.Name:lower():find("shop") then
            createESPBox(obj, Color3.new(1, 0, 0), "SELL")
        end
    end
end

-- Object Finding Functions
local function findItems()
    local items = {}
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj.Name:match("^Item%d*$") then
            table.insert(items, obj)
        end
    end
    return items
end

local function findEggs()
    local eggs = {}
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj.Name:match("^Egg%d*$") then
            table.insert(eggs, obj)
        end
    end
    return eggs
end

local function findMoney()
    local money = {}
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj.Name:lower():find("money") or obj.Name:lower():find("cash") or obj.Name:lower():find("coin") then
            table.insert(money, obj)
        end
    end
    return money
end

local function findSellAreas()
    local sellAreas = {}
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj.Name:lower():find("sell") or obj.Name:lower():find("shop") or obj.Name:lower():find("merchant") then
            table.insert(sellAreas, obj)
        end
    end
    return sellAreas
end

-- Movement Functions
local function smoothWalkTo(targetPosition)
    if not targetPosition or not humanoid or not rootPart then return false end
    
    local distance = (rootPart.Position - targetPosition).Magnitude
    
    if flyEnabled then
        local bodyVel = rootPart:FindFirstChild("BodyVelocity")
        if bodyVel then
            local direction = (targetPosition - rootPart.Position).Unit
            bodyVel.Velocity = direction * 50
        end
    else
        humanoid:MoveTo(targetPosition)
    end
    
    return true
end

local function walkToObject(targetObject)
    if not targetObject or not targetObject.Parent then return false end
    
    local targetPosition
    if targetObject:IsA("Model") then
        local primaryPart = targetObject.PrimaryPart or targetObject:FindFirstChild("HumanoidRootPart") or targetObject:FindFirstChildOfClass("BasePart")
        if primaryPart then
            targetPosition = primaryPart.Position
        else
            targetPosition = targetObject:GetModelCFrame().Position
        end
    elseif targetObject:IsA("BasePart") then
        targetPosition = targetObject.Position
    else
        return false
    end
    
    if not character or not character.Parent then
        character = player.Character
        if not character then return false end
        humanoid = character:FindFirstChild("Humanoid")
        rootPart = character:FindFirstChild("HumanoidRootPart")
    end
    
    return smoothWalkTo(targetPosition)
end

-- Interaction Functions
local function interactWithObject(targetObject)
    if not targetObject then return false end
    
    local prompt = targetObject:FindFirstChildOfClass("ProximityPrompt")
    if not prompt then
        for _, child in pairs(targetObject:GetDescendants()) do
            if child:IsA("ProximityPrompt") then
                prompt = child
                break
            end
        end
    end
    
    if prompt then
        prompt.HoldDuration = 0
        prompt:InputHoldBegin()
        wait(0.1)
        prompt:InputHoldEnd()
        return true
    end
    
    return false
end

local function modifyProximityPrompts()
    for _, prompt in pairs(game:GetDescendants()) do
        if prompt:IsA("ProximityPrompt") then
            prompt.HoldDuration = 0
        end
    end
end

-- Auto Farm Money Function
local function autoFarmMoney()
    if not autoFarmMoneyEnabled then return end
    
    local items = findItems()
    
    if #items > 0 then
        local closestItem = nil
        local closestDistance = math.huge
        
        for _, item in pairs(items) do
            if item and item.Parent then
                local itemPos = item:IsA("Model") and item:GetModelCFrame().Position or item.Position
                local distance = (rootPart.Position - itemPos).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestItem = item
                end
            end
        end
        
        if closestItem then
            walkToObject(closestItem)
            wait(0.1)
            interactWithObject(closestItem)
        end
    end
end

-- Auto Buy Eggs Function
local function autoBuyEggs()
    if not autoBuyEggsEnabled then return end
    
    local eggs = findEggs()
    
    if #eggs > 0 then
        local closestEgg = nil
        local closestDistance = math.huge
        
        for _, egg in pairs(eggs) do
            if egg and egg.Parent then
                local eggPos = egg:IsA("Model") and egg:GetModelCFrame().Position or egg.Position
                local distance = (rootPart.Position - eggPos).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestEgg = egg
                end
            end
        end
        
        if closestEgg then
            walkToObject(closestEgg)
            wait(0.5)
            interactWithObject(closestEgg)
        end
    end
end

-- Auto Game Function (Complete Automation)
local function autoGame()
    if not autoGameEnabled then return end
    
    -- Priority system: Items > Money > Eggs > Sell Areas
    local items = findItems()
    local money = findMoney()
    local eggs = findEggs()
    local sellAreas = findSellAreas()
    
    -- First priority: Collect items for money
    if #items > 0 then
        local closestItem = nil
        local closestDistance = math.huge
        
        for _, item in pairs(items) do
            if item and item.Parent then
                local itemPos = item:IsA("Model") and item:GetModelCFrame().Position or item.Position
                local distance = (rootPart.Position - itemPos).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestItem = item
                end
            end
        end
        
        if closestItem then
            walkToObject(closestItem)
            wait(0.1)
            interactWithObject(closestItem)
        end
        
    -- Second priority: Collect money
    elseif #money > 0 then
        local closestMoney = nil
        local closestDistance = math.huge
        
        for _, moneyObj in pairs(money) do
            if moneyObj and moneyObj.Parent then
                local moneyPos = moneyObj:IsA("Model") and moneyObj:GetModelCFrame().Position or moneyObj.Position
                local distance = (rootPart.Position - moneyPos).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestMoney = moneyObj
                end
            end
        end
        
        if closestMoney then
            walkToObject(closestMoney)
            wait(0.1)
            interactWithObject(closestMoney)
        end
        
    -- Third priority: Buy eggs
    elseif #eggs > 0 then
        local closestEgg = nil
        local closestDistance = math.huge
        
        for _, egg in pairs(eggs) do
            if egg and egg.Parent then
                local eggPos = egg:IsA("Model") and egg:GetModelCFrame().Position or egg.Position
                local distance = (rootPart.Position - eggPos).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestEgg = egg
                end
            end
        end
        
        if closestEgg then
            walkToObject(closestEgg)
            wait(0.5)
            interactWithObject(closestEgg)
        end
        
    -- Fourth priority: Go to sell areas
    elseif #sellAreas > 0 then
        local closestSellArea = nil
        local closestDistance = math.huge
        
        for _, sellArea in pairs(sellAreas) do
            if sellArea and sellArea.Parent then
                local sellPos = sellArea:IsA("Model") and sellArea:GetModelCFrame().Position or sellArea.Position
                local distance = (rootPart.Position - sellPos).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestSellArea = sellArea
                end
            end
        end
        
        if closestSellArea then
            walkToObject(closestSellArea)
            wait(0.5)
            interactWithObject(closestSellArea)
        end
    end
end

-- Create Rayfield Interface
local Window = Rayfield:CreateWindow({
    Name = "Sing Hub",
    LoadingTitle = "Sing Hub Loading",
    LoadingSubtitle = "Complete Auto Game Script",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "SingHubConfig",
        FileName = "Config"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvitelink",
        RememberJoins = true
    },
    KeySystem = false
})

-- Main Tab
local MainTab = Window:CreateTab("🎮 Main", 4483362458)

-- Auto Game Toggle
local AutoGameToggle = MainTab:CreateToggle({
    Name = "Auto Game (Complete Automation)",
    CurrentValue = false,
    Flag = "AutoGameToggle",
    Callback = function(Value)
        autoGameEnabled = Value
        
        if Value then
            if humanoid then
                humanoid.WalkSpeed = 50
            end
            
            gameConnection = RunService.Heartbeat:Connect(autoGame)
            
            Rayfield:Notify({
                Title = "Auto Game",
                Content = "Complete automation enabled!",
                Duration = 3,
                Image = 4483362458
            })
        else
            if humanoid then
                humanoid.WalkSpeed = originalWalkSpeed
            end
            
            if gameConnection then
                gameConnection:Disconnect()
                gameConnection = nil
            end
            
            Rayfield:Notify({
                Title = "Auto Game",
                Content = "Complete automation disabled!",
                Duration = 3,
                Image = 4483362458
            })
        end
    end
})

-- Auto Farm Money Toggle
local AutoFarmMoneyToggle = MainTab:CreateToggle({
    Name = "Auto Farm Money (Items Only)",
    CurrentValue = false,
    Flag = "AutoFarmMoneyToggle",
    Callback = function(Value)
        autoFarmMoneyEnabled = Value
        
        if Value then
            if humanoid then
                humanoid.WalkSpeed = 50
            end
            
            farmConnection = RunService.Heartbeat:Connect(autoFarmMoney)
            
            Rayfield:Notify({
                Title = "Auto Farm Money",
                Content = "Item farming enabled!",
                Duration = 3,
                Image = 4483362458
            })
        else
            if humanoid then
                humanoid.WalkSpeed = originalWalkSpeed
            end
            
            if farmConnection then
                farmConnection:Disconnect()
                farmConnection = nil
            end
            
            Rayfield:Notify({
                Title = "Auto Farm Money",
                Content = "Item farming disabled!",
                Duration = 3,
                Image = 4483362458
            })
        end
    end
})

-- Auto Buy Eggs Toggle
local AutoBuyEggsToggle = MainTab:CreateToggle({
    Name = "Auto Buy Eggs",
    CurrentValue = false,
    Flag = "AutoBuyEggsToggle",
    Callback = function(Value)
        autoBuyEggsEnabled = Value
        
        if Value then
            if humanoid then
                humanoid.WalkSpeed = 50
            end
            
            buyConnection = RunService.Heartbeat:Connect(autoBuyEggs)
            
            Rayfield:Notify({
                Title = "Auto Buy Eggs",
                Content = "Egg purchasing enabled!",
                Duration = 3,
                Image = 4483362458
            })
        else
            if humanoid then
                humanoid.WalkSpeed = originalWalkSpeed
            end
            
            if buyConnection then
                buyConnection:Disconnect()
                buyConnection = nil
            end
            
            Rayfield:Notify({
                Title = "Auto Buy Eggs",
                Content = "Egg purchasing disabled!",
                Duration = 3,
                Image = 4483362458
            })
        end
    end
})

-- Fly Toggle
local FlyToggle = MainTab:CreateToggle({
    Name = "Fly",
    CurrentValue = false,
    Flag = "FlyToggle",
    Callback = function(Value)
        flyEnabled = Value
        toggleFly()
        
        if Value then
            Rayfield:Notify({
                Title = "Fly",
                Content = "Flight enabled!",
                Duration = 3,
                Image = 4483362458
            })
        else
            Rayfield:Notify({
                Title = "Fly",
                Content = "Flight disabled!",
                Duration = 3,
                Image = 4483362458
            })
        end
    end
})

-- Walk Speed Slider
local WalkSpeedSlider = MainTab:CreateSlider({
    Name = "Walk Speed",
    Range = {16, 100},
    Increment = 1,
    Suffix = " Speed",
    CurrentValue = 50,
    Flag = "WalkSpeedSlider",
    Callback = function(Value)
        if humanoid then
            humanoid.WalkSpeed = Value
        end
    end
})

-- ESP Tab
local ESPTab = Window:CreateTab("👁️ ESP", 4483362458)

-- ESP Toggle
local ESPToggle = ESPTab:CreateToggle({
    Name = "ESP Boxes",
    CurrentValue = false,
    Flag = "ESPToggle",
    Callback = function(Value)
        espEnabled = Value
        
        if Value then
            updateESP()
            
            spawn(function()
                while espEnabled do
                    updateESP()
                    wait(2)
                end
            end)
            
            Rayfield:Notify({
                Title = "ESP",
                Content = "ESP visualization enabled!",
                Duration = 3,
                Image = 4483362458
            })
        else
            clearESP()
            
            Rayfield:Notify({
                Title = "ESP",
                Content = "ESP visualization disabled!",
                Duration = 3,
                Image = 4483362458
            })
        end
    end
})

-- Manual ESP Update
local UpdateESPButton = ESPTab:CreateButton({
    Name = "Update ESP",
    Callback = function()
        updateESP()
        Rayfield:Notify({
            Title = "ESP",
            Content = "ESP display updated!",
            Duration = 2,
            Image = 4483362458
        })
    end
})

-- Settings Tab
local SettingsTab = Window:CreateTab("⚙️ Settings", 4483362458)

-- Fast Open Toggle
local FastOpenToggle = SettingsTab:CreateToggle({
    Name = "Fast Open (Proximity Prompts)",
    CurrentValue = false,
    Flag = "FastOpenToggle",
    Callback = function(Value)
        fastOpenEnabled = Value
        
        if Value then
            modifyProximityPrompts()
            
            ProximityPromptService.PromptButtonHoldBegan:Connect(function(prompt)
                if fastOpenEnabled then
                    prompt.HoldDuration = 0
                end
            end)
            
            Rayfield:Notify({
                Title = "Fast Open",
                Content = "Instant interactions enabled!",
                Duration = 3,
                Image = 4483362458
            })
        else
            Rayfield:Notify({
                Title = "Fast Open",
                Content = "Normal interaction speed restored!",
                Duration = 3,
                Image = 4483362458
            })
        end
    end
})

-- Apply Fast Open Button
local ApplyFastOpenButton = SettingsTab:CreateButton({
    Name = "Apply Fast Open to All Prompts",
    Callback = function()
        modifyProximityPrompts()
        Rayfield:Notify({
            Title = "Fast Open",
            Content = "Fast interactions applied globally!",
            Duration = 3,
            Image = 4483362458
        })
    end
})

-- Game Analysis Button
local AnalyzeButton = SettingsTab:CreateButton({
    Name = "Analyze Game Environment",
    Callback = function()
        local items = findItems()
        local eggs = findEggs()
        local money = findMoney()
        local sellAreas = findSellAreas()
        
        Rayfield:Notify({
            Title = "Game Analysis",
            Content = "Items: " .. #items .. " | Eggs: " .. #eggs .. " | Money: " .. #money .. " | Sell Areas: " .. #sellAreas,
            Duration = 5,
            Image = 4483362458
        })
    end
})

-- Character Reconnection Management
player.CharacterAdded:Connect(function(newCharacter)
    character = newCharacter
    humanoid = character:WaitForChild("Humanoid")
    rootPart = character:WaitForChild("HumanoidRootPart")
    
    if autoFarmMoneyEnabled or autoBuyEggsEnabled or autoGameEnabled then
        humanoid.WalkSpeed = WalkSpeedSlider.CurrentValue or 50
    end
    
    if flyEnabled then
        wait(1)
        toggleFly()
    end
end)

-- Script Load Notification
Rayfield:Notify({
    Title = "Sing Hub",
    Content = "Complete automation system loaded successfully!",
    Duration = 5,
    Image = 4483362458
})

print("Sing Hub Complete Auto Game Script loaded successfully!")
